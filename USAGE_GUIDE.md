# Only Beauty 薪資計算系統 - 使用指南

## 問題解決：pandas 模組找不到

如果遇到 `ModuleNotFoundError: No module named 'pandas'` 錯誤，請按照以下步驟解決：

### 解決方案

#### 方法1：使用啟動腳本（推薦）
```bash
python start.py
```
這個腳本會自動檢查環境並啟動程式。

#### 方法2：使用虛擬環境的 Python
```bash
/Users/ben_kuo/only_beauty/.venv/bin/python salary_calculator.py
```

#### 方法3：重新安裝套件
```bash
pip install pandas openpyxl xlrd
```

### 累進制獎金計算

程式已經更新為累進制計算，包括：

#### 業績獎金（累進制）
- 第一階：1,800,000~2,500,000 → 0.5%
- 第二階：2,500,001~4,000,000 → 1%
- 第三階：4,000,001~6,000,000 → 2.5%  
- 第四階：6,000,001~8,000,000 → 4.5%

#### 消耗獎金（累進制）
- 第一階：0~1,500,000 → 0.6%
- 第二階：1,500,001~2,500,000 → 1%
- 第三階：2,500,001以上 → 1.5%

#### 分配規則
- **顧問**：業績獎金70%，消耗獎金40%
- **美容師/護士**：業績獎金30%，消耗獎金60%

#### 達標條件
- 顧問業績獎金：個人業績達168萬才發放
- 顧問消耗獎金：個人業績達120萬才發放

### 計算範例

假設總業績 E5 = 5,000,000：
```
業績獎金累進計算：
- 第一階：(2,500,000 - 1,800,000) × 0.5% = 3,500
- 第二階：(4,000,000 - 2,500,000) × 1% = 15,000  
- 第三階：(5,000,000 - 4,000,000) × 2.5% = 25,000
總計：43,500

顧問池：43,500 × 70% = 30,450
美容師/護士池：43,500 × 30% = 13,050
```

### 路徑格式

支援以下路徑格式：
- `~/only_beauty_report/Hsinchu202506.xlsx`
- `/Users/ben_kuo/Desktop/檔案名.xlsx`
- 拖拽檔案到終端獲得完整路徑

### 常見問題

1. **pandas 找不到**：使用 `python start.py` 啟動
2. **檔案路徑錯誤**：使用 `~` 符號或拖拽檔案
3. **工作表找不到**：確認 Excel 有數字工作表名稱

### 檔案結構

```
only_beauty/
├── salary_calculator.py    # 主程式
├── start.py               # 啟動器
├── run.sh                 # Shell 腳本
├── requirements.txt       # 套件清單
└── README.md             # 說明文件
```

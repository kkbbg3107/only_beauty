# Only Beauty 薪資計算系統 - 網頁版

基於原有Python薪資計算程式轉換的網頁版應用，提供更直觀的使用者介面。

## 主要功能

### 📁 檔案上傳
- 支援拖拽上傳或點擊選擇Excel檔案
- 即時進度條顯示解析進度
- 檔案格式驗證 (.xlsx, .xls)

### 📊 薪資計算
- **產品銷售統計**: 自動統計各顧問產品銷售組數
- **團體獎金計算**: 累進制業績和消耗獎金
- **個人獎金計算**: 店長/顧問個人業績和消耗獎金
- **薪資明細計算**: 美容師/護理師/櫃檯完整薪資明細

### 🎨 使用者介面
- 響應式設計，支援手機和平板
- 步驟式引導操作流程
- 分頁顯示計算結果
- 即時錯誤提示

## 安裝與執行

### 1. 環境需求
- Python 3.7+
- pip 套件管理器

### 2. 安裝相依套件
```bash
pip install -r requirements.txt
```

### 3. 啟動應用
```bash
python run.py
```

### 4. 開啟瀏覽器
前往 http://localhost:5000

## 使用說明

### 步驟 1: 上傳Excel檔案
1. 拖拽Excel檔案到上傳區域，或點擊「選擇檔案」按鈕
2. 系統會自動驗證檔案格式並顯示解析進度
3. 解析完成後自動進入下一步

### 步驟 2: 設定基本資料
1. **員工人數**: 輸入美容師和護理師的總人數（必填）
2. **店長名稱**: 如果有店長請輸入名稱（可選）
3. **高標金額**: 設定高標達標獎金的業績門檻（可選）

### 步驟 3: 查看計算進度
系統會顯示四個計算階段的進度：
- 🛍️ 統計產品銷售
- 👥 計算團體獎金
- 👤 計算個人獎金
- 💰 計算薪資明細

### 步驟 4: 查看結果
結果分為四個分頁：
- **顧問獎金**: 各顧問的團體業績/消耗獎金明細
- **員工獎金**: 美容師/護理師的團體獎金總額
- **薪資明細**: 個別員工的完整薪資計算
- **統計摘要**: 總計數據統計

## 檔案結構

```
web_app/
├── app.py                 # Flask後端主程式
├── run.py                 # 啟動腳本
├── requirements.txt       # Python相依套件
├── README.md             # 說明文件
├── templates/
│   └── index.html        # 主頁面模板
├── static/
│   ├── style.css         # 樣式表
│   └── script.js         # JavaScript功能
└── uploads/              # 暫存上傳檔案目錄
```

## 技術架構

### 前端
- **HTML5**: 語意化結構和現代表單元素
- **CSS3**: Flexbox/Grid佈局、動畫效果、響應式設計
- **JavaScript**: 檔案上傳、AJAX通訊、動態UI更新

### 後端
- **Flask**: Python網頁框架
- **pandas**: Excel檔案讀取和資料處理
- **openpyxl**: Excel檔案格式支援

### 核心功能
- **檔案上傳處理**: 安全的檔案驗證和暫存機制
- **Excel解析**: 自動偵測數字工作表並讀取資料
- **薪資計算引擎**: 完整移植原有Python程式邏輯
- **結果序列化**: JSON格式的資料傳輸

## 安全特性

1. **檔案類型驗證**: 僅允許Excel格式檔案
2. **檔案大小限制**: 最大16MB檔案限制
3. **檔案名安全處理**: 使用secure_filename()處理檔案名
4. **暫存檔案清理**: 計算完成後自動刪除上傳檔案
5. **錯誤處理**: 完整的例外處理和錯誤回饋

## 效能最佳化

1. **並行處理**: 前端JavaScript並行執行多個獨立操作
2. **進度回饋**: 視覺化進度條提升使用者體驗
3. **檔案清理**: 避免暫存檔案累積
4. **資源壓縮**: CSS/JS檔案結構化組織

## 相容性

- **瀏覽器**: Chrome 70+, Firefox 65+, Safari 12+, Edge 79+
- **作業系統**: Windows, macOS, Linux
- **檔案格式**: Excel 2007+ (.xlsx), Excel 97-2003 (.xls)

## 故障排除

### 常見問題

1. **檔案上傳失敗**
   - 檢查檔案格式是否為 .xlsx 或 .xls
   - 確認檔案大小小於 16MB
   - 檢查檔案是否損壞

2. **計算錯誤**
   - 確認Excel檔案包含數字工作表
   - 檢查資料格式是否符合預期
   - 查看瀏覽器控制台的錯誤訊息

3. **頁面無法載入**
   - 確認 Python 相依套件已正確安裝
   - 檢查 5000 端口是否被佔用
   - 查看終端機的錯誤訊息

### 開發模式

如需開發或除錯，可以直接執行：
```bash
python app.py
```

這會啟用 Flask 的除錯模式，提供詳細的錯誤資訊。

## 版本歷史

- **v1.0.0**: 初始版本，完整功能實現
  - 檔案上傳與進度條
  - 薪資計算引擎
  - 響應式UI介面
  - 結果匯出功能

## 授權

此專案為 Only Beauty 內部使用工具。# only_beauty

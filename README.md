# Only Beauty 薪資計算系統使用說明

## 功能說明
這個程式專門為 Only Beauty 店計算季度團體獎金，包括：
- 顧問業績獎金和消耗獎金
- 美容師/護士業績獎金和消耗獎金

## 使用方法

### 1. 執行程式
```bash
python salary_calculator.py
```

### 2. 輸入Excel檔案路徑
程式會要求您輸入Excel報表的完整路徑

### 3. 輸入美容師/護士人數
輸入店內正式美容師和護士的總人數

### 4. 查看計算結果
程式會自動計算並顯示所有獎金明細

## Excel檔案格式要求

### 工作表要求
- 必須包含數字名稱的工作表（如: 1, 2, 3, 202412等）
- 程式會自動選擇數字最大的工作表

### 數據位置要求
- **E5**: 當月實際總業績
- **E7**: 當月總消耗
- **A9及以下**: 顧問名稱列表（直到遇到空格為止）
- **C欄**: 對應顧問的個人業績
- **G欄**: 對應顧問的消耗
- 注意：名為"公司"的項目會被自動排除

## 獎金計算規則

### 業績獎金等級
| 等級 | 金額範圍 | 比例 |
|------|----------|------|
| 第一階 | 1,800,000~2,500,000 | 0.5% |
| 第二階 | 2,500,001~4,000,000 | 1% |
| 第三階 | 4,000,001~6,000,000 | 2.5% |
| 第四階 | 6,000,001~8,000,000 | 4.5% |

### 消耗獎金等級
| 等級 | 金額範圍 | 比例 |
|------|----------|------|
| 第一階 | ~1,500,000 | 0.6% |
| 第二階 | 1,500,001~2,500,000 | 1% |
| 第三階 | 2,500,001以上 | 1.5% |

### 分配比例
- **顧問**: 業績獎金70%，消耗獎金40%
- **美容師/護士**: 業績獎金30%，消耗獎金60%

### 顧問分配條件
- 業績獎金：顧問需達個人業績目標168萬才發放
- 消耗獎金：顧問需達個人業績目標120萬才發放

## 範例計算

假設：
- E5總業績 = 5,000,000
- E7總消耗 = 4,000,000
- 美容師/護士總人數 = 10人

### 顧問A（個人業績2,000,000，個人消耗1,800,000）
- 業績獎金：5,000,000 × 0.7 × 0.025 × (2,000,000/5,000,000) = 35,000
- 消耗獎金：4,000,000 × 0.4 × 0.015 × (1,800,000/4,000,000) = 10,800
- 總獎金：45,800

### 美容師/護士（每人）
- 業績獎金：5,000,000 × 0.3 × 0.025 ÷ 10 = 3,750
- 消耗獎金：4,000,000 × 0.6 × 0.015 ÷ 10 = 3,600
- 總獎金：7,350

## 注意事項
1. Excel檔案必須是.xlsx或.xls格式
2. 確保數據位置正確（E5, E7, A欄顧問名稱等）
3. 顧問名稱列表中"公司"項目會被自動排除
4. 程式會自動處理空值和格式問題

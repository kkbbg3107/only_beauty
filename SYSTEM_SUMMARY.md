# Only Beauty 薪資計算系統 - 功能總結

## 已完成功能

### 1. ✅ 基本系統架構
- Excel 檔案讀取 (支援中文/英文檔名、~路徑、絕對路徑)
- 自動選擇數字最大的工作表
- 路徑建議功能 (檔案不存在時)
- 錯誤處理和用戶友好的提示

### 2. ✅ 團體獎金計算
- **顧問團體獎金** (累進制)
  - 業績獎金池：總業績按累進制計算 × 70%
  - 消耗獎金池：總消耗按累進制計算 × 40%
  - 按個人業績/消耗比例分配
  - 產品未達標者清零

- **美容師/護理師團體獎金** (累進制)
  - 業績獎金池：總業績按累進制計算 × 30%
  - 消耗獎金池：總消耗按累進制計算 × 60%
  - 按人數平均分配

### 3. ✅ 個人獎金計算
- **店長級距**: 業績/消耗使用店長級距表
- **顧問級距**: 業績/消耗使用顧問級距表
- 自動識別店長身份 (用戶輸入店長名稱)
- 累進制計算個人業績獎金和個人消耗獎金

### 4. ✅ 產品達標獎金
- 遍歷所有工作表統計產品銷售
- 精確比對"購產品"三字
- 30組以上給予2000元獎金
- 產品未達標者團體獎金清零

### 5. ✅ 高標達標獎金 (新功能)
- 用戶輸入高標金額
- 與E5總業績比對
- 達標時自動分配：
  - 美容師：5,000元
  - 護理師：10,000元

### 6. ✅ 個別員工薪資計算 (新功能)
- **美容師** (K9-K15, L/M欄)
  - 底薪+加班費：從L欄讀取
  - 手技獎金：從M欄讀取
  - 團體業績/消耗獎金：按人數分配
  - 高標達標獎金：5,000元

- **護理師** (N9-N15, O/P欄)
  - 底薪+加班費：從O欄讀取
  - 手技獎金：從P欄讀取
  - 執照津貼：5,000元/月
  - 全勤獎金：2,000元 (季度發放)
  - 團體業績/消耗獎金：按人數分配
  - 高標達標獎金：10,000元

- **櫃檯** (Q9-Q15, S欄手技獎金)
  - 底薪+加班費：從R欄讀取
  - 手技獎金：從S欄讀取
  - 職等獎金：1,946元
  - 職務津貼：2,000元
  - 不參與團體獎金分配

### 7. ✅ 完整報表顯示
- 顧問獎金明細 (團體+個人+產品)
- 美容師/護理師團體獎金摘要
- 產品達標獎金摘要
- 高標達標獎金明細
- 個別員工薪資明細 (按職位分組)

## 技術特點

### 數據處理
- 支援Excel多工作表讀取
- 智能空值處理
- 中文檔名和路徑支援
- 錯誤容錯機制

### 計算邏輯
- 累進制獎金計算 (業績/消耗)
- 多層級獎金分配 (團體/個人/產品/高標)
- 達標條件檢查
- 職位差異化處理

### 用戶體驗
- 清晰的操作流程
- 詳細的結果顯示
- 錯誤提示和建議
- 退出機制 (exit/quit)

## 測試覆蓋

### 已建立測試腳本
- `test_new_logic.py`: 累進制獎金計算測試
- `test_individual_bonus.py`: 個人獎金計算測試
- `test_fixed_calc.py`: 固定計算邏輯測試
- `test_individual_staff.py`: 個別員工薪資測試
- `simple_test.py`: 基本功能測試

### 測試場景
- ✅ 正常數據處理
- ✅ 邊界條件測試
- ✅ 錯誤輸入處理
- ✅ 空值和缺失數據
- ✅ 不同職位組合

## 文件說明

### 主要文件
- `salary_calculator.py`: 主程式
- `requirements.txt`: 依賴套件
- `README.md`: 系統說明
- `USAGE_GUIDE.md`: 使用指南
- `INDIVIDUAL_SALARY_GUIDE.md`: 個別薪資功能說明

### 配置文件
- 累進制級距表 (內建於程式中)
- 高標達標獎金配置
- 固定津貼配置

## 使用流程

```
1. 執行 python salary_calculator.py
2. 輸入 Excel 檔案路徑
3. 輸入美容師/護理師總人數
4. 輸入店長名稱 (或 'n' 表示無店長)
5. 輸入高標達標金額 (可選)
6. 系統自動計算並顯示完整薪資報表
```

## 輸出範例

```
薪資計算結果
======================================================================

顧問獎金明細:
------------------------------------------------------------
王小美:
  個人業績: 2,000,000
  個人消耗: 800,000
  團體業績獎金: 45,000
  團體消耗獎金: 25,000
  產品銷售: 35 組
  產品達標獎金: 2,000
  個人業績獎金: 24,000 (店長)
  個人消耗獎金: 15,000 (店長)
  團體獎金小計: 70,000
  團體+產品獎金: 72,000
  個人獎金小計: 39,000
  【總獎金】: 111,000

高標達標獎金:
------------------------------------------------------------
美容師A (美容師): 5,000 元
護理師A (護理師): 10,000 元
高標達標獎金總額: 15,000 元

個別員工薪資明細:
--------------------------------------------------------------------------------

美容師:
------------------------------------------------------------

美容師A (第9行):
  底薪: 30,154
  手技獎金: 5,000
  團體業績獎金: 12,500
  團體消耗獎金: 8,750
  高標達標獎金: 5,000
  【總薪資】: 61,404

護理師:
------------------------------------------------------------

護理師A (第9行):
  底薪: 31,178
  手技獎金: 8,000
  團體業績獎金: 12,500
  團體消耗獎金: 8,750
  高標達標獎金: 10,000
  執照津貼: 5,000
  全勤獎金: 2,000
  【總薪資】: 77,428

櫃檯:
------------------------------------------------------------

櫃檯A (第9行):
  底薪: 31,054
  手技獎金: 2,000
  職等獎金: 1,946
  職務津貼: 2,000
  【總薪資】: 37,000
```

## 總結

Only Beauty 薪資計算系統現已完成所有需求功能：
- ✅ 團體獎金計算 (累進制)
- ✅ 個人獎金計算 (店長/顧問分級)
- ✅ 產品達標獎金
- ✅ 高標達標獎金
- ✅ 個別員工薪資明細
- ✅ 完整報表輸出

系統支援季度發放機制，能正確處理各種獎金類型，並提供清晰的薪資明細報表。
